<div ng-if="parent">
	<div class="row">
		<h1 class="page-header">
			<img src="/assets/images/customers.png"
				style="width: 50px; height: 50px;"></img>&nbsp; <span>
				Resellers</span>

		</h1>
	</div>

	<ul class="nav nav-tabs">
		<li ng-class="{active:isSet(1)}"><a href ng-click="setTab(1)"><b>Resellers</b></a></li>
		<li ng-class="{active:isSet(2)}"><a href ng-click="setTab(2)"><b>Customers</b></a></li>
		<li ng-class="{active:isSet(3)}"><a href ng-click="setTab(3)"><b>Complaints</b></a></li>
	</ul>

	<div ng-show="isSet(1)">
		<!-- ----- Reseller details ----- -->
		<div class="panel panel-default">
<div class="panel-heading">
					<b>Reseller</b>
				</div>
 				<br>

	<!-- 	<button class="btn btn-primary pull-right" type="button"
				style="margin: 10px 10px 10px 0px;" ng-click="addNewRes()">
				<i class="fa fa-plus-circle"></i>&nbsp; Add New Reseller
			</button>
			
			<br> &nbsp; <hr />  -->
			
			<div class="panel-body">
				<div class="row text-center" ng-if="resellers.length == 0">
					<div class="col-lg-12 col-md-12 col-sm-12">
						<h4>
							<label>There are no Resellers</label>
						</h4>
					</div>
				</div>

				<div class="row" ng-if="resellers.length > 0">
					<div class="col-lg-12 col-md-12 col-sm-12 table-responsive">
						<table datatable class="table table-bordered table-striped"
							style="width: 100%;">
							<thead>
								<tr>
									<td style="width: 30%;"><b>Company Name</b></td>
									<td style="width: 20%;"><b>PAN</b></td>
									<td style="width: 30%;"><b>Customer support details</b></td>
									<td style="width: 20%;"><b>Current Subscription Status</b></td>
									<!-- <td style="width: 10%;"><b>Action</b></td> -->
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="reseller in resellers track by $index"
									class="item">
									<td style="width: 30%;" class="text-left">
										<!--  <button style="text-align: left;" class="btn-link"
											type="button" ng-click="viewRes(reseller.id,'RESELLER')"> -->{{reseller.companyName}}<!-- </button> -->
									</td>
									<td style="width: 20%;">{{reseller.pan}}</td>
									<td style="width: 30%;" class="text-left"><span
										ng-if="customer.custSupportName!=''"> <span
											title="Support Name" class="glyphicon glyphicon-user"></span>
											{{reseller.custSupportName}}<br> <span title="Phone No."
											class="glyphicon glyphicon-phone-alt"></span>
											{{reseller.custSupportPhone}}<br> <span title="Email"
											class="glyphicon glyphicon-envelope"></span>
											{{reseller.custSupportEmail}}
									</span></td>
									<td style="width: 20%;">{{reseller.curSubscriptionStatus}}</td>
									<!-- <td>
										<button type="button" ng-model="editMode"
											class="btn btn-primary btn-xs"
											ng-click="editRes(reseller.id, 'RESELLER')">
											<span class="glyphicon glyphicon-edit"></span> Edit
										</button> <br /> <br /> 
									</td> -->
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div ng-show="isSet(2)">
		<div class="panel panel-default" style="width: 100%;">
				<div class="panel-heading">
					<b>Customer Details</b>
				</div>
				<div class="panel-body table-responsive">
					<div class="col-lg-4 col-md-4 col-sm-4">
							<label>Reseller </label>
							<select class="form-control" ng-model="m" ng-change="changedValue(m)">
								<option value="">-- Select --</option>
								<option ng-repeat="m in resellers"  
								value="{{m.id}}">{{m.companyName}}</option>
							</select>
						</div>
				<br>
				<br>
				<br>
				<div class="row text-center" ng-if="companyDetailData.length==0">
						<br>
						<h4>
							<label>There are no Customers</label>
						</h4>
						<br>
					</div>
					<br>
				<br>
					<div ng-if="companyDetailData.length > 0">
						<table datatable class="table table-bordered table-striped">
							<thead>
								<tr>
									<td><b>Company Name</b></td>
									<td><b>PAN</b></td>
									<!-- <td><b>Address</b></td> -->
									<td><b>Contact details</b></td>
									<td><b>Factory Locations</b></td>
									<td><b>Machines</b></td>
									<td><b>Current Subscription Status</b></td>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="customer in companyDetailData track by $index"
									class="item">
									<td>{{customer.companyDetail.companyName}}</td>
									<td>{{customer.companyDetail.pan}}</td>
									<!-- <td>{{customer.companyDetail.address}}</td> -->
									<td style="font-family: verdana; font-size: 11px;"><span
										ng-if="customer.custSupportName!=''"> <span
											title="Name" class="glyphicon glyphicon-user"></span>
											{{customer.companyDetail.custSupportName}}<br> <span
											title="Phone No." class="glyphicon glyphicon-phone-alt"></span>
											{{customer.companyDetail.custSupportPhone}}
									</span></td>
								<td align="center"><b><button class="btn-link btn-sm" type="button"
											ng-click="getLocation(customer.companyDetail)" data-toggle="modal"
											data-target="#viewLocation" ng-if="factoryLocationsCount!=0"><span
										>{{customer.factoryLocationsCount}}</span></button>
										<span ng-if="factoryLocationsCount==0">0</span> </b></td>
								<td align="center"><b><button class="btn-link btn-sm" type="button"
											ng-click="getMachine(customer.companyDetail)" data-toggle="modal"
											data-target="#viewMachine" ng-if="machinesCount!=0"><span
										>{{customer.machinesCount}}</span></button>
										<span ng-if="customer.machinesCount==0">0</span> </b></td>
								<!-- <td align="center"><b> <span ng-if="machinesCount!=0">{{customer.machinesCount}}</span>
										<span ng-if="customer.machinesCount==0">0</span>
								</b></td> -->
								<td>{{customer.companyDetail.curSubscriptionStatus}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>  
			</div>
		</div>
	</div>

	<div ng-show="isSet(3)">  
		<div class="panel panel-default">
			<div class="panel-heading"><b>Complaints</b></div>				
			<div class="panel-body table-responsive">				
				<!-- 	<div class="form-group">
						<div class="col-lg-4 col-md-4 col-sm-4">
							<label>Reseller </label>
							<select class="form-control" ng-model="mab" ng-change="changedValue(mab)">
								<option value="">-- Select --</option>
								<option ng-repeat="mab in resellers"  
								value="{{mab.id}}">{{mab.companyName}}</option>
							</select>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-4">
							<label>Customer</label>
							<select class="form-control" id = "customerD" ng-model="ma" ng-change="changedValueCustomerDropDown(ma)">
								<option value="">-- Select --</option>
								<option ng-repeat="ma in companyDetailData"  
								value="{{ma.companyDetail.id}}">{{ma.companyDetail.companyName}}</option>
							</select>					 
						</div>
						<div class="col-lg-4 col-md-4 col-sm-4">
							<label>Machine</label>							 
							<select class="form-control" ng-model="ma1" ng-change="changedValueMachineDropDown(ma1)">
								<option value="">-- Select --</option>
								<option ng-repeat="ma1 in machines"  
								value="{{ma1.id}}">{{ma1.qrCode}}</option>
							</select>
						</div>
					</div> -->
		
				
		 		<div class="row text-right">
					<div class="col-lg-12 col-md-12 col-sm-12">
						<button type="button" class="btn btn-primary btn-sm" id="btnDownloadAsExcel"
							  ng-click="onDownloadAsExcel()" title="Download As Excel">
							  <i class="glyphicon glyphicon-download"></i> Download As Excel</button>
					</div>
									
				</div> 
				
				<div class="row text-center" ng-if="complaints.length == 0"><br>
					<h4><label>There are no Complaints</label></h4><br>
				</div> 
				
				<br>
				<table datatable class="table table-bordered" ng-if="complaints.length > 0" style="width: 100%;">
					<thead>
						<tr>
							<td><b>Complaint Number</b></td>
							<td><b>Machine Model</b></td>
							<td><b>Machine Serial</b></td>
							<td><b>Reported Date</b></td>
							<td><b>Assigned Date</b></td>
							<td><b>Assigned To</b></td>
							<td><b>Closed Date</b></td>
							<td><b>Status</b></td>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="complaint in complaints track by $index" class="item">
							<td><button title="View complaint details"  
							style="text-align: left;" class="btn-link" type="button" ng-click="viewDetails(complaint)">
							{{ complaint.issue.issueNumber}}</button></td> 
							<td>{{ complaint.issue.machineModelNumber }}</td>
							<td>{{ complaint.issue.machineSerialNumber }}</td>
							<td>{{ complaint.issue.dateReported | date:"dd-MM-yyyy" }}</td>
							<td>{{ complaint.issue.dateAssigned | date:"dd-MM-yyyy" }}</td>
							<td>{{ complaint.issue.technicianName }}</td>
							<td>{{ complaint.issue.dateClosed | date:"dd-MM-yyyy" }}</td>
							<td>{{ complaint.issue.status }}</td> 
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<!---------------------------------- Modal Dialog for view issue details ------------------------->
<style>
.view-detail-content{
font-family: Courier New;
font-size: 14px; 
}
</style>
<div id="viewIssueDetails" class="modal fade" role="dialog">
	<form name="viewIssueDetailsForm">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">View Details (Compliant No.: {{ viewComplaint.issue.issueNumber }})</h4>
				</div>
				<div style="padding: 3%; height: 400px; overflow-y: auto;">
					<table class="table table-bordered" style="font-size:14px;  width:100%;" >												
						<tr>
							<td style="width:40%"><b>Machine Model</b></td>
							<td style="width:60%">							 
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.machineModelNumber}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Machine Serial</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.machineSerialNumber}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Machine Installation Date</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.machineInstallationDate | date:"dd-MM-yyyy"}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Reseller Name</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.reseller.companyName}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Customer Company Name</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.customerCompanyName}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Machine Location</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.machineLocationNameAddress}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Complaint Details</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.details}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Operator Name</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.phonedeviceOperatorName}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Reported Date</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.dateReported | date:"dd-MM-yyyy"}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Assigned Date</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.dateAssigned | date:"dd-MM-yyyy"}}
								</p>
							</td>
						</tr>
						<tr ng-if="user.role == 'MANUFACTURERADMIN' || user.role == 'RESELLERADMIN'">
							<td><b>Assigned Technician</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.technicianName}}
								</p>
							</td>
						</tr>						
						<tr>
							<td><b>Closed Date</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.dateClosed | date:"dd-MM-yyyy"}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Failure Reason</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.failureReason}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Action Taken</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.actionTaken}}
								</p>
							</td>
						</tr>
						<tr>
							<td><b>Status</b></td>
							<td>
								<p class="view-detail-content"> 
								{{ viewComplaint.issue.status}}
								</p>
							</td>
						</tr> 						 
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">
						<i class="fa fa-minus-circle"></i>&nbsp; Cancel
					</button>
				</div>
			</div>
		</div>
	</form>
</div> 

<!-- -------------------------------------Location Dialog-------------------------------------------------------------------  -->

<style>
.view-detail-content{
font-family: Courier New;
font-size: 14px; 
}
</style>
<div id="viewLocation" class="modal fade" role="dialog">
	<form name="viewLocationForm">
		<div class="modal-dialog">
			<div class="modal-content">
			<br>
			<label style="margin-left:20px;">Factory Location</label>
			<br>
				<div class="col-lg-12 col-md-12 col-sm-12 table-responsive">
				<br><br>
					<table datatable dt-options="{paging: true}"
						class="table table-bordered table-striped"
						ng-if="factoryLocations.length>0" style="width: 100%;">
						<thead>
							<tr>
								<td><b>Location Address</b></td>
								<td><b>Contact Person</b></td>
								<td><b>Contact Number</b></td>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="location in factoryLocations track by $index"
								class="item">
								<td>{{location.companyLocationAddress.locationName}} <br>
									{{location.companyLocationAddress.locationAddress}}
								</td>
								<td>{{location.contactPerson}}</td>
								<td>{{location.contactMobile}}</td>
							</tr>
						</tbody>
					</table>
				</div>
				<br>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">
						<i class="fa fa-minus-circle"></i>&nbsp; Cancel
					</button>
				</div>
			</div>
		</div>
	</form>
</div>

<!-- -------------------------------------Machine Dialog-------------------------------------------------------------------  -->
 <style>
.view-detail-content{
font-family: Courier New;
font-size: 14px; 
}
</style>
<div id="viewMachine" class="modal fade" role="dialog">
	<form name="viewMachineForm">
		<div class="modal-dialog">
			<div class="modal-content">
			<br>
			<label style="margin-left:20px;">Factory Location</label>
			<br>
				<div class="col-lg-12 col-md-12 col-sm-12 table-responsive">
				<br><br>
					<table datatable dt-options="{paging: true}"
						class="table table-bordered table-striped"
						ng-if="machines.length>0" style="width: 100%;">
						<thead>
							<tr>
								<td><b>Machine Model</b></td>
								<td><b>Serial Number</b></td>
								<td><b>QR-Code</b></td>
								<td><b>Machine Name</b></td>
								<td><b>Installation Date</b></td>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="ma in machines track by $index"
								class="item">
								<td>{{ma.modelNumber}}</td>
								<td>{{ma.serialNumber}}</td>
								<td>{{ma.qrCode}}</td>
								<td>{{ma.name}}</td>
								<td>{{ma.installationDate | date:"dd-MM-yyyy"}}</td>
							</tr>
						</tbody>
					</table>
				</div>
				<br>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" data-dismiss="modal">
						<i class="fa fa-minus-circle"></i>&nbsp; Cancel
					</button>
				</div>
			</div>
	</form>
</div>
